//특정조건을 만족하는 물고기별 수와 최대 길이 구하기
SELECT COUNT(ID) AS FISH_COUNT, MAX(IFNULL(LENGTH, 10)) AS MAX_LENGTH, FISH_TYPE
FROM FISH_INFO
GROUP BY FISH_TYPE
HAVING AVG(IFNULL(LENGTH, 10)) >= 33
ORDER BY FISH_TYPE ASC;
//업그레이드 할 수 없는 아이템 구하기
SELECT ITEM_ID, ITEM_NAME, RARITY
FROM ITEM_INFO
WHERE ITEM_ID NOT IN (SELECT PARENT_ITEM_ID
                     FROM ITEM_TREE
                     WHERE NOT ISNULL(PARENT_ITEM_ID))
ORDER BY ITEM_ID DESC;
//물고기 종류별 대어찾기
SELECT ID, FISH_NAME, LENGTH
FROM FISH_INFO F LEFT JOIN FISH_NAME_INFO N ON F.FISH_TYPE = N.FISH_TYPE
WHERE (F.FISH_TYPE, F.LENGTH) IN (SELECT FISH_TYPE, MAX(LENGTH)
                               FROM FISH_INFO
                               GROUP BY FISH_TYPE)
ORDER BY 1;
