//대여 횟수가 많은 자동차들의 월별 대여 횟수 구하기
SELECT MONTH(START_DATE) AS MONTH, CAR_ID, COUNT(HISTORY_ID) AS RECORDS
FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
WHERE START_DATE >= '2022-08-01' AND START_DATE < '2022-11-01' AND CAR_ID IN (SELECT CAR_ID FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY 
                            WHERE START_DATE >= '2022-08-01' AND START_DATE < '2022-11-01'
                            GROUP BY CAR_ID
                            HAVING COUNT(HISTORY_ID) > 4)
GROUP BY MONTH, CAR_ID
HAVING RECORDS > 0
ORDER BY MONTH, CAR_ID DESC;
//대장균들의 자식의 수 구하기
SELECT D.ID, COALESCE(T.COUNT, 0) AS CHILD_COUNT
FROM ECOLI_DATA D LEFT JOIN (SELECT PARENT_ID, COUNT(*) AS COUNT 
                             FROM ECOLI_DATA
                             GROUP BY PARENT_ID
                             HAVING PARENT_ID IS NOT NULL) T ON D.ID = T.PARENT_ID
                             ORDER BY ID;
