//저자 별 카테고리 별 매출액 집계하기
SELECT B.AUTHOR_ID, A.AUTHOR_NAME, B.CATEGORY, SUM(B.PRICE*S.SALES) AS TOTAL_SALES 
FROM BOOK B JOIN AUTHOR A ON B.AUTHOR_ID = A.AUTHOR_ID JOIN BOOK_SALES S ON B.BOOK_ID = S.BOOK_ID
WHERE YEAR(S.SALES_DATE) = 2022 AND MONTH(S.SALES_DATE) = 1
GROUP BY AUTHOR_ID, CATEGORY
ORDER BY B.AUTHOR_ID ASC, B.CATEGORY DESC; 
//우유와 요거트가 담긴 장바구니
SELECT DISTINCT P.CART_ID
FROM CART_PRODUCTS P INNER JOIN CART_PRODUCTS PT ON P.CART_ID = PT.CART_ID
WHERE P.NAME = "Milk" AND PT.NAME = "Yogurt"
ORDER BY 1;
//주문량이 많은 아이스크림들 조회하기
SELECT H.FLAVOR
FROM FIRST_HALF H LEFT JOIN JULY J ON H.FLAVOR = J.FLAVOR
GROUP BY H.FLAVOR
ORDER BY (SUM(J.TOTAL_ORDER) + SUM(H.TOTAL_ORDER)) DESC LIMIT 3;
